# ุฑุงูููุง ุงุณุชูุงุฏู ุงุฒ ูุฏุฑุช ุชุฑุงูฺฉ ุงุฌูุช

## ูุญู ุฏุณุชุฑุณ

### ุตูุญู ุงุตู: `/admin/adminuser/`

ุฏุฑ ุฏุงุดุจูุฑุฏ ุงุฏูู HiddifyPanelุ ุจู ุจุฎุด **Admin Users** ุจุฑูุฏ:
- ูุณุฑ: `Admin Panel` โ `Admin Users` (ุง `/admin/adminuser/`)

## ูุงุจูุชโูุง ููุฌูุฏ

### 1. ุฏุฑ ูุณุช AdminUser ูุง

ุฏุฑ ูุณุช AdminUser ูุงุ ุณุชููโูุง ุฒุฑ ุงุถุงูู ุดุฏู:

- **Traffic Limit (GB)**: ุญุฏ ูุฌุงุฒ ุชุฑุงูฺฉ ุจุฑุง ุงุฌูุช
- **Total Traffic (GB)**: ูุฌููุน ุชุฑุงูฺฉ ูุตุฑู ุชูุงู ฺฉุงุฑุจุฑุงู ุงุฌูุช
- **Remaining Traffic (GB)**: ุชุฑุงูฺฉ ุจุงููุงูุฏู
- **Traffic Status**: ูุถุนุช ุชุฑุงูฺฉ ุจุง progress bar ู badge ุฑูฺฏ

**ูฺฉุชู**: ุงู ุณุชููโูุง ููุท ุจุฑุง ุงุฌูุชโูุง (mode = agent) ููุงุด ุฏุงุฏู ูโุดููุฏ.

### 2. ุฏุฑ ูุฑู ุงุฌุงุฏ/ูุฑุงุด AdminUser

ููุช ฺฉ AdminUser ุฌุฏุฏ ูโุณุงุฒุฏ ุง ูุฑุงุด ูโฺฉูุฏ:

1. **ููุฏ "Traffic Limit (GB)"**:
   - ุจุฑุง ุงุฌูุชโูุง (mode = agent) ููุงุด ุฏุงุฏู ูโุดูุฏ
   - ูโุชูุงูุฏ ุญุฏ ูุฌุงุฒ ุชุฑุงูฺฉ ุฑุง ุจู GB ูุงุฑุฏ ฺฉูุฏ
   - ุฎุงู ฺฏุฐุงุดุชู = ุจุฏูู ูุญุฏูุฏุช (Unlimited)

2. **ูุซุงู**:
   - ุงฺฏุฑ ูโุฎูุงูุฏ ุงุฌูุช ููุท 1000 GB ุชุฑุงูฺฉ ุฏุงุดุชู ุจุงุดุฏ: `1000` ูุงุฑุฏ ฺฉูุฏ
   - ุงฺฏุฑ ูโุฎูุงูุฏ ุจุฏูู ูุญุฏูุฏุช: ููุฏ ุฑุง ุฎุงู ุจฺฏุฐุงุฑุฏ

### 3. Action ุจุฑุง ุจุฑุฑุณ ุชุฑุงูฺฉ

ุฏุฑ ูุณุช AdminUser ูุง:
- ูโุชูุงูุฏ ฺูุฏ ุงุฌูุช ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ
- Action "Check Traffic & Disable if Exceeded" ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ
- ุณุณุชู ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ุชุฑุงูฺฉ ุฑุง ุจุฑุฑุณ ูโฺฉูุฏ
- ุงฺฏุฑ ุชุฑุงูฺฉ ุงุฒ ุญุฏ ูุฌุงุฒ ุชุฌุงูุฒ ฺฉุฑุฏู ุจุงุดุฏุ ุชูุงู ฺฉุงุฑุจุฑุงู ุงุฌูุช ุบุฑูุนุงู ูโุดููุฏ

## ูุญูู ุงุณุชูุงุฏู

### ุชูุธู ูุญุฏูุฏุช ุชุฑุงูฺฉ ุจุฑุง ฺฉ ุงุฌูุช:

1. ุจู `/admin/adminuser/` ุจุฑูุฏ
2. ุฑู ุงุฌูุช ููุฑุฏ ูุธุฑ ฺฉูฺฉ ฺฉูุฏ (Edit)
3. ุฏุฑ ููุฏ "Traffic Limit (GB)" ููุฏุงุฑ ุฑุง ูุงุฑุฏ ฺฉูุฏ (ูุซูุงู `1000`)
4. Save ฺฉูุฏ

### ูุดุงูุฏู ูุถุนุช ุชุฑุงูฺฉ:

1. ุฏุฑ ูุณุช AdminUser ูุงุ ุณุชููโูุง ุชุฑุงูฺฉ ุฑุง ุจุจูุฏ:
   - **Traffic Status**: ุจุง progress bar ู ุฑูฺฏ:
     - ๐ข ุณุจุฒ (OK): ฺฉูุชุฑ ุงุฒ 90% ุงุณุชูุงุฏู ุดุฏู
     - ๐ก ุฒุฑุฏ (Warning): ุจู 90% ุชุง 100%
     - ๐ด ูุฑูุฒ (Exceeded): ุงุฒ ุญุฏ ูุฌุงุฒ ุชุฌุงูุฒ ฺฉุฑุฏู

### ุจุฑุฑุณ ุฎูุฏฺฉุงุฑ ุชุฑุงูฺฉ:

ุณุณุชู ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ:
- โ ูุจู ุงุฒ ุงุฌุงุฏ ฺฉุงุฑุจุฑ ุฌุฏุฏุ ุชุฑุงูฺฉ ุงุฌูุช ุฑุง ุจุฑุฑุณ ูโฺฉูุฏ
- โ ุงฺฏุฑ ุชุฑุงูฺฉ ุงุฒ ุญุฏ ูุฌุงุฒ ุชุฌุงูุฒ ฺฉุฑุฏู ุจุงุดุฏุ ุงุฌุงุฒู ุงุฌุงุฏ ฺฉุงุฑุจุฑ ุฌุฏุฏ ููโุฏูุฏ
- โ ูุฑ 5 ุฏููู ฺฉ ุจุงุฑุ ุชุฑุงูฺฉ ุชูุงู ุงุฌูุชโูุง ุฑุง ุจุฑุฑุณ ูโฺฉูุฏ
- โ ุงฺฏุฑ ุชุฑุงูฺฉ ุงุฒ ุญุฏ ูุฌุงุฒ ุชุฌุงูุฒ ฺฉุฑุฏู ุจุงุดุฏุ ุชูุงู ฺฉุงุฑุจุฑุงู ุงุฌูุช ุฑุง ุบุฑูุนุงู ูโฺฉูุฏ

## ูุซุงู ุนูู

### ุณูุงุฑู 1: ุชูุธู ูุญุฏูุฏุช 500 GB ุจุฑุง ฺฉ ุงุฌูุช

1. ุจู `/admin/adminuser/` ุจุฑูุฏ
2. ุงุฌูุช ุฑุง ูุฑุงุด ฺฉูุฏ
3. ุฏุฑ ููุฏ "Traffic Limit (GB)" ููุฏุงุฑ `500` ุฑุง ูุงุฑุฏ ฺฉูุฏ
4. Save ฺฉูุฏ

**ูุชุฌู**:
- ุงุฌูุช ููุท ูโุชูุงูุฏ ฺฉุงุฑุจุฑุงู ุจุง ูุฌููุน ุชุฑุงูฺฉ 500 GB ุงุฌุงุฏ ฺฉูุฏ
- ุงฺฏุฑ ูุฌููุน ุชุฑุงูฺฉ ฺฉุงุฑุจุฑุงู ุจู 500 GB ุจุฑุณุฏุ ุงุฌุงุฒู ุงุฌุงุฏ ฺฉุงุฑุจุฑ ุฌุฏุฏ ุฏุงุฏู ููโุดูุฏ
- ุงฺฏุฑ ุงุฒ 500 GB ุชุฌุงูุฒ ฺฉูุฏุ ุชูุงู ฺฉุงุฑุจุฑุงู ุบุฑูุนุงู ูโุดููุฏ

### ุณูุงุฑู 2: ูุดุงูุฏู ูุถุนุช ุชุฑุงูฺฉ

ุฏุฑ ูุณุช AdminUser ูุง:
- ุงุฌูุช A: Traffic Limit = 1000 GB, Total Traffic = 750 GB, Status = ๐ข OK (75%)
- ุงุฌูุช B: Traffic Limit = 500 GB, Total Traffic = 480 GB, Status = ๐ก Warning (96%)
- ุงุฌูุช C: Traffic Limit = 200 GB, Total Traffic = 210 GB, Status = ๐ด Exceeded (105%)

## ูฺฉุงุช ููู

1. **ููุท ุจุฑุง ุงุฌูุชโูุง**: ุงู ูุงุจูุช ููุท ุจุฑุง AdminUser ูุง ุจุง mode = `agent` ฺฉุงุฑ ูโฺฉูุฏ
2. **ูุญุงุณุจู ุชุฑุงูฺฉ**: ุชุฑุงูฺฉ ูุญุงุณุจู ุดุฏู ุดุงูู ุชูุงู ฺฉุงุฑุจุฑุงู ุงุฌุงุฏ ุดุฏู ุชูุณุท ุงุฌูุช ู sub-admin ูุง ุขู ุงุณุช
3. **ุบุฑูุนุงูโุณุงุฒ ุฎูุฏฺฉุงุฑ**: ุงฺฏุฑ ุชุฑุงูฺฉ ุงุฒ ุญุฏ ูุฌุงุฒ ุชุฌุงูุฒ ฺฉูุฏุ ุชูุงู ฺฉุงุฑุจุฑุงู ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ุบุฑูุนุงู ูโุดููุฏ
4. **ุจุฑุฑุณ ุฏูุฑูโุง**: ุณุณุชู ูุฑ 5 ุฏููู ฺฉ ุจุงุฑ ุชุฑุงูฺฉ ุฑุง ุจุฑุฑุณ ูโฺฉูุฏ

## API Endpoints

ุงฺฏุฑ ูโุฎูุงูุฏ ุงุฒ API ุงุณุชูุงุฏู ฺฉูุฏ:

```bash
# ุฏุฑุงูุช ุงุทูุงุนุงุช ุชุฑุงูฺฉ ฺฉ ุงุฌูุช
GET /api/v1/agent-traffic/{admin_id}

# ุชูุธู ูุญุฏูุฏุช ุชุฑุงูฺฉ
PUT /api/v1/agent-traffic/{admin_id}
Content-Type: application/json
{
  "traffic_limit_GB": 1000
}

# ุจุฑุฑุณ ุชุฑุงูฺฉ ฺฉ ุงุฌูุช
POST /api/v1/agent-traffic/{admin_id}/check
```

## ุนุจโุงุจ

### ุงฺฏุฑ ููุฏ "Traffic Limit (GB)" ุฑุง ููโุจูุฏ:

1. ุจุฑุฑุณ ฺฉูุฏ ฺฉู AdminUser mode = `agent` ุจุงุดุฏ
2. ุจุฑุฑุณ ฺฉูุฏ ฺฉู ูุงฺูู ุจู ุฏุฑุณุช ูุตุจ ุดุฏู ุจุงุดุฏ:
   ```bash
   /opt/hiddify-manager/.venv313/bin/python -c "import hiddify_agent_traffic_manager; print('OK')"
   ```
3. ุจุฑุฑุณ ูุงฺฏโูุง:
   ```bash
   journalctl -u hiddify-panel -n 100 --no-pager | grep -i traffic
   ```

### ุงฺฏุฑ ุณุชููโูุง ุชุฑุงูฺฉ ุฑุง ููโุจูุฏ:

1. ุจุฑุฑุณ ฺฉูุฏ ฺฉู ูุงฺูู ุจู ุฏุฑุณุช extend ุดุฏู ุจุงุดุฏ
2. ุตูุญู ุฑุง refresh ฺฉูุฏ (Ctrl+F5)
3. ุจุฑุฑุณ ฺฉูุฏ ฺฉู AdminUser mode = `agent` ุจุงุดุฏ

